{"version":3,"sources":["../../src/pages/hello-world/hello-world.module.ts","../../src/pages/hello-world/hello-world.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { HelloWorldPage } from './hello-world';\n\n@NgModule({\n  declarations: [\n    HelloWorldPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(HelloWorldPage),\n  ],\n})\nexport class HelloWorldPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/hello-world/hello-world.module.ts","import { Component,  NgZone  } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Platform } from 'ionic-angular';\n\n////\n// NOTE:  normally you will simply import from \"cordova-background-geolocation-lt\" or \"cordova-background-geolocation\"\n// from \"../../cordova-background-geolocation\" is only fro convenience in the SampleApp for easily switching\n// between public / private version of the plugin\n//\nimport BackgroundGeolocation, {\n  Location,\n  HttpEvent,\n  MotionActivityEvent,\n  ProviderChangeEvent,\n  MotionChangeEvent,\n  ConnectivityChangeEvent,\n  AuthorizationEvent,\n  TransistorAuthorizationToken\n} from \"../../cordova-background-geolocation\";\n\nimport ENV from \"../../ENV\";\n\n@IonicPage()\n@Component({\n  selector: 'page-hello-world',\n  templateUrl: 'hello-world.html',\n})\nexport class HelloWorldPage {\n  // UI State\n  enabled: boolean;\n  isMoving: boolean;\n\n  // ion-list datasource\n  events: any;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, private platform: Platform,  private zone:NgZone) {\n    this.isMoving = false;\n    this.enabled = false;\n    this.events = [];\n\n    // Listen for deviceready to configure BackgroundGeolocation\n    this.platform.ready().then(this.onDeviceReady.bind(this));\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad HelloWorldPage');\n  }\n\n  onDeviceReady() {\n    this.configureBackgroundGeolocation();\n  }\n\n  async configureBackgroundGeolocation() {\n    // Compose #url: tracker.transistorsoft.com/locations/{username}\n    let localStorage = (<any>window).localStorage;\n\n    let token:TransistorAuthorizationToken = await BackgroundGeolocation.findOrCreateTransistorAuthorizationToken(\n      localStorage.getItem('orgname'),\n      localStorage.getItem('username'),\n      ENV.TRACKER_HOST\n    );\n\n    // Step 1:  Listen to events\n    BackgroundGeolocation.onLocation(this.onLocation.bind(this));\n    BackgroundGeolocation.onMotionChange(this.onMotionChange.bind(this));\n    BackgroundGeolocation.onActivityChange(this.onActivityChange.bind(this));\n    BackgroundGeolocation.onHttp(this.onHttpSuccess.bind(this));\n    BackgroundGeolocation.onProviderChange(this.onProviderChange.bind(this));\n    BackgroundGeolocation.onPowerSaveChange(this.onPowerSaveChange.bind(this));\n    BackgroundGeolocation.onConnectivityChange(this.onConnectivityChange.bind(this));\n    BackgroundGeolocation.onAuthorization(this.onAuthorization.bind(this));\n\n    // Step 2:  Configure the plugin\n    BackgroundGeolocation.ready({\n      reset: true,\n      debug: true,\n      logLevel: BackgroundGeolocation.LOG_LEVEL_VERBOSE,\n      distanceFilter: 10,\n      stopTimeout: 1,\n      stopOnTerminate: false,\n      startOnBoot: true,\n      url: ENV.TRACKER_HOST + '/api/locations',\n      // [Android] backgroundPermissionRationale for Always permission.\n      backgroundPermissionRationale: {\n        title: \"Allow {applicationName} to access this device's location even when closed or not in use.\",\n        message: \"This app collects location data to enable recording your trips to work and calculate distance-travelled.\",\n        positiveAction: 'Change to \"{backgroundPermissionOptionLabel}\"',\n        negativeAction: 'Cancel'\n      },\n      authorization: {  // <-- JWT authorization for tracker.transistorsoft.com\n        strategy: 'jwt',\n        accessToken: token.accessToken,\n        refreshToken: token.refreshToken,\n        refreshUrl: ENV.TRACKER_HOST + '/api/refresh_token',\n        refreshPayload: {\n          refresh_token: '{refreshToken}'\n        },\n        expires: token.expires\n      },\n      autoSync: true\n    }, (state) => {\n      console.log('- Configure success: ', state);\n      // Update UI state (toggle switch, changePace button)\n      this.zone.run(() => {\n        this.isMoving = state.isMoving;\n        this.enabled = state.enabled;\n      });\n    });\n  }\n  // Return to Home screen (app switcher)\n  onClickHome() {\n    this.navCtrl.setRoot('HomePage');\n  }\n\n  // #start / #stop tracking\n  onToggleEnabled() {\n    if (this.enabled) {\n      BackgroundGeolocation.start();\n    } else {\n      BackgroundGeolocation.stop();\n    }\n  }\n\n  // Fetch the current position\n  onClickGetCurrentPosition() {\n    BackgroundGeolocation.getCurrentPosition({persist: true}, (location) => {\n      console.log('- getCurrentPosition: ', location);\n    }, (error) => {\n      console.warn('- Location error: ', error);\n    });\n  }\n\n  // Change plugin state between stationary / tracking\n  onClickChangePace() {\n    this.isMoving = !this.isMoving;\n    BackgroundGeolocation.changePace(this.isMoving);\n  }\n\n  // Clear the list of events from ion-list\n  onClickClear() {\n    this.events = [];\n  }\n\n  /**\n  * @event location\n  */\n  onLocation(location:Location) {\n    console.log('[event] location: ', location);\n    let event = location.event || 'location';\n\n    this.zone.run(() => {\n      this.addEvent(event, new Date(location.timestamp), location);\n    })\n  }\n  /**\n  * @event motionchange\n  */\n  onMotionChange(event:MotionChangeEvent) {\n    console.log('[event] motionchange, isMoving: ', event.isMoving, ', location: ', event.location);\n    this.zone.run(() => {\n      this.isMoving = event.isMoving;\n    });\n  }\n  /**\n  * @event activitychange\n  */\n  onActivityChange(event:MotionActivityEvent) {\n    console.log('[event] activitychange: ', event);\n    this.zone.run(() => {\n      this.addEvent('activitychange', new Date(), event);\n    });\n  }\n  /**\n  * @event http\n  */\n  onHttpSuccess(response:HttpEvent) {\n    console.log('[event] http: ', response);\n    this.zone.run(() => {\n      this.addEvent('http', new Date(), response);\n    });\n  }\n  onHttpFailure(response:HttpEvent) {\n    console.warn('[event] http failure: ', response);\n    this.zone.run(() => {\n      this.addEvent('http failure', new Date(), response);\n    });\n  }\n  /**\n  * @event providerchange\n  */\n  onProviderChange(provider:ProviderChangeEvent) {\n    console.log('[event] providerchange', provider);\n    this.zone.run(() => {\n      this.addEvent('providerchange', new Date(), provider);\n    });\n  }\n  /**\n  * @event powersavechange\n  */\n  onPowerSaveChange(isPowerSaveEnabled:boolean) {\n    console.log('[event] powersavechange', isPowerSaveEnabled);\n    this.zone.run(() => {\n      this.addEvent('powersavechange', new Date(), {isPowerSaveEnabled: isPowerSaveEnabled});\n    });\n  }\n  /**\n  * @event connectivitychange\n  */\n  onConnectivityChange(event:ConnectivityChangeEvent) {\n    console.log('[event] connectivitychange connected? ', event.connected);\n  }\n  /**\n  * @event authorization\n  */\n  onAuthorization(event:AuthorizationEvent) {\n    console.log('[event] authorization: ', event);\n  }\n  /**\n  * Add a record to ion-list\n  * @param {String} event name\n  * @param {Date} date\n  * @param {Object} event object, eg: {location}, {provider}, {activity}\n  */\n  private addEvent(name, date, event) {\n    let timestamp = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();\n\n    this.events.unshift({\n      name: name,\n      timestamp: timestamp,\n      object: event,\n      content: JSON.stringify(event, null, 2)\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/hello-world/hello-world.ts"],"sourceRoot":""}